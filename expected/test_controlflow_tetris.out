SET client_min_messages TO WARNING;
create or replace language plpython3u;
create extension if not exists pg_rollup;
create table testtetris (
    id serial primary key,
    num int,
    val boolean
);
CREATE MATERIALIZED VIEW testtetris_rollup1 AS (
    SELECT
        sum(num),
        bool_and(val)
    FROM testtetris
);
select pgrollup_manage_all();
 pgrollup_manage_all 
---------------------
 
(1 row)

select * from testtetris_rollup1_raw;
 sum(testtetris.num) | bool_and(testtetris.val) | raw_true 
---------------------+--------------------------+----------
                   0 | t                        | t
(1 row)

-- FIXME: add more column types
drop table testtetris cascade;
